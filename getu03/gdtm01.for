C TEST JEDNOTKOVE STREDNI CHYBY
C=======================================================================
C         1. VERZE  /ZARI 1984/         VUGTK
C       * 5. VERZE      /ZARI 1989/             VUGTK      ALES CEPEK
C
      SUBROUTINE GDTM01
C
$INCLUDE: 'GDTSOW.COM'
      INTEGER  I
      PARAMETER (ID=27)
      INTEGER*1  T54(ID),S(13),C(13),T56(70)
      CHARACTER*70 CT56
      EQUIVALENCE (CT56,T56)
      REAL  ALFPUL,DMEZ,HMEZ,MTCHI1,M0D,M0S
51    FORMAT(/' POCET NADBYTECNYCH POZOROVANI:',I4)
53    FORMAT(' M0''/M0:',F6.3)
C*54  FORMAT(F6.2,'% INTERVAL (',F6.3,',',F6.3,')',<ID>A1)
54    FORMAT(F6.2,'% INTERVAL (',F6.3,',',F6.3,')',27A1)
55    FORMAT(' M0''/M0 (DELKY):',F6.3,'  M0''/M0 (SMERY):',F6.3)
56    FORMAT(
     /' PRO DELKU ',13A1,' --> ',13A1,' PLATI M0''''/M0:',F6.3,7X)
561   FORMAT(70A1)
57    FORMAT(' TEST NELZE PROVEST')
58    FORMAT(' M0''                          :',E12.5,' [MM/CC]')
      WRITE(ITT,51)  NADBPO
0103  IF(NADBPO.GT.0)  GOTO 0199
         WRITE(ITT,57)
         RETURN
0199  CONTINUE
      WRITE(ITT,58)  M01
      CALL GDSSTR(1,9)
      CALL GDTTHL(GSGDPT,'TEST M0:')
      WRITE(GSGDPT,53)  M01/M0
      WRITE(ITT   ,53)  M01/M0
      ALFPUL = (1E2-PRST)/2E2
      DMEZ = SQRT(MTCHI1(1E0-ALFPUL,NADBPO)/NADBPO)
      HMEZ = SQRT(MTCHI1(    ALFPUL,NADBPO)/NADBPO)
C                    12345678901234567890123456789012345678901234567890
      CALL PPMOV1(1,' NEOBSAHUJE HODNOTU M0''/M0 ',1,T54,1,ID)
      M0D = M01/M0
0203  IF(.NOT.(DMEZ.LE.M0D.AND.HMEZ.GE.M0D))  GOTO 0299
         T54(2) = ' '
         T54(3) = ' '
         CALL GDSMEZ(T54,ID,I)
0299  CONTINUE
      CALL GDSSTR(1,0)
      WRITE(GSGDPT,54)  PRST,DMEZ,HMEZ,T54
      WRITE(ITT   ,54)  PRST,DMEZ,HMEZ,T54
0303  IF(.NOT.(SUMQVS.GT.0E0.AND.SUMQVD.GT.0E0))  GOTO 0399
         M0D = SQRT(SUMVVD/SUMQVD)/M0
         M0S = SQRT(SUMVVS/SUMQVS)/M0
         CALL GDSSTR(1,0)
         WRITE(GSGDPT,55)  M0D,M0S
         WRITE(ITT   ,55)  M0D,M0S
0399  CONTINUE
0403  IF(NADBPO.LE.1)  GOTO 0499
         CALL GDTEXT(CST(INDELT),S)
         CALL GDTEXT(CCI(INDELT),C)
C*       ENCODE(70,56,T56)  S,C,SQRT(ABS(PVV-MAXDLT)/(NADBPO-1))/M0
         WRITE(CT56,56)     S,C,SQRT(ABS(PVV-MAXDLT)/(NADBPO-1))/M0
         IF(TYPP(INDELT).EQ.'S')  CALL PPMOV1(1,'SMER ',1,T56,6,5)
         CALL GDSMEZ(T56,70,I)
         CALL GDSSTR(1,0)
         WRITE(GSGDPT,561)  T56
         WRITE(ITT   ,561)  T56
0499  CONTINUE
C
      END
